language: c
os: linux
dist: bionic
compiler: gcc
env: COMPILER=gcc
addons:
  apt:
    packages:
      - flex
      - bison
      - libsqlite3-dev
      - libsctp-dev
      - libradcli-dev
      - libhiredis-dev
      - unixodbc-dev
      - libconfuse-dev
      - libmysqlclient-dev
      - libexpat1-dev
      - libxml2-dev
      - libpq-dev
      - zlib1g-dev
      - libperl-dev
      - libsnmp-dev
      - libdb-dev
      - libldap2-dev
      - libcurl4-gnutls-dev
      - libgeoip-dev
      - libpcre3-dev
      - libmemcached-dev
      - libmicrohttpd-dev
      - librabbitmq-dev
      - liblua5.1-0-dev
      - libncurses5-dev
      - libjson-c-dev
      - uuid-dev
      - python-dev
      - libmaxminddb-dev
#      - libjwt-dev
  sonarcloud:
    organization: "l2dy-sonarcloud"
    token:
      secure: "GwgekzdRdJHGFgQfygtKKgw7ymuFW2rRMweVS/hd9fiL9gJ1rRC09sNf0DU0XLG07weKrxJEa3mwG7xcttEllMknObp9W9tAQwKiO9npIcIMX2EwMqZaJAYqcMRFesEgR8IA34N/n/mqNYzM0tZz4hN5u1MlNSfaaut7Yifu3qf2BgsLn/XQe0ll58/qaWqrKD+Ns7PZzdY30MtdpTFZNrn9nLP8TVl6G7ZUR09BkrXADevhpeePQetSl5SBX5xu1Yx+uwPUQR7SbpBdE/rHzDbFfzoLjIm33I97pzztaxERMH1vyjAfHbG/kCb4Ggj3PHyubYUragIn0E8zQaJWLr9eT3gRpei/qJNnAyysVuZGduTEn0YrolgImtiAxDUgyPt2GpGKi97+t6snXdnEax0Hj92MzSTvFKuJhE+T4NX0ihep3PfDadE0FhuE4jyKiRrOcfqfNN5mU6eDWYo1Ut+/f3tL1HABM1XGHI/AcpYB1/5aL2POC2bEVCKnnryfY0Z52/AT8RxmQnJTwv1M6YBv5HcwwxdcyI8H458e0+asLQuVNjj0IhT1EC/fh2JBNFjtmzogetwBpLVoCSrO0SJVeVWkewkArumBy30ffYr2wp5M6J0Cci5C2pmKDzyPdaFjVPihzozYAxzyaImmr8daejlav6ShZPlV60L/OiY=" # encrypted value of your token

before_install: sh -x scripts/build/install_depends.sh
script:
  # Wraps the compilation with the Build Wrapper to generate configuration (used
  # later by the SonarScanner) into the "bw-output" folder
  - build-wrapper-linux-x86-64 --out-dir bw-output make exclude_modules="db_oracle osp sngtc cachedb_cassandra cachedb_couchbase cachedb_mongodb auth_jwt" all
  # And finally run the SonarCloud analysis - read the "sonar-project.properties"
  # file to see the specific configuration
  - sonar-scanner -Dsonar.cfamily.build-wrapper-output=bw-output -Dsonar.cfamily.threads=2 -Dsonar.cfamily.cache.enabled=false
